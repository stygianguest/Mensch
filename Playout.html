<!DOCTYPE HTML>
<html><head><meta charset="UTF-8"><title>Playout</title><script type="text/javascript" src="elm-runtime.js"></script><script type="text/javascript">Elm.Playout = Elm.Playout || {};
Elm.Playout.make = function (_elm)
                   {
                     "use strict";
                     _elm.Playout = _elm.Playout || {};
                     if (_elm.Playout.values)
                     return _elm.Playout.values;
                     var _N = Elm.Native,
                         _U = _N.Utils.make(_elm),
                         _L = _N.List.make(_elm),
                         _E = _N.Error.make(_elm),
                         _J = _N.JavaScript.make(_elm),
                         $moduleName = "Playout";
                     var Basics = Elm.Basics.make(_elm);
                     var Color = Elm.Color.make(_elm);
                     var Dict = Elm.Dict.make(_elm);
                     var GameLogic = Elm.GameLogic.make(_elm);
                     var Graphics = Graphics || {};
                     Graphics.Collage = Elm.Graphics.Collage.make(_elm);
                     var Graphics = Graphics || {};
                     Graphics.Element = Elm.Graphics.Element.make(_elm);
                     var List = Elm.List.make(_elm);
                     var Maybe = Elm.Maybe.make(_elm);
                     var Mouse = Elm.Mouse.make(_elm);
                     var Native = Native || {};
                     Native.Ports = Elm.Native.Ports.make(_elm);
                     var PieChart = Elm.PieChart.make(_elm);
                     var Random = Elm.Random.make(_elm);
                     var Signal = Elm.Signal.make(_elm);
                     var String = Elm.String.make(_elm);
                     var Text = Elm.Text.make(_elm);
                     var Time = Elm.Time.make(_elm);
                     var Util = Elm.Util.make(_elm);
                     var Window = Elm.Window.make(_elm);
                     var _op = {};
                     var aiPlayoff = F2(function (strats,rseed)
                                        {
                                          return function ()
                                                 {
                                                   var firstGame = A2(GameLogic.seedRand,
                                                                      rseed,
                                                                      GameLogic.initGameState);
                                                   var stratDict = Dict.fromList(Util.enumerate(strats));
                                                   var player = function (n)
                                                                {
                                                                  return A2(GameLogic.computerPlayer,
                                                                            Util.fromJust(A2(Dict.lookup,
                                                                                             n,
                                                                                             stratDict)),
                                                                            n);
                                                                };
                                                   var playTurn = function (gs)
                                                                  {
                                                                    return A2(GameLogic.execCmd,
                                                                              A2(player,
                                                                                 gs.currentPlayer,
                                                                                 gs),
                                                                              gs);
                                                                  };
                                                   var playOut = A2(Util.applyUntil,
                                                                    playTurn,
                                                                    function ($)
                                                                    {
                                                                      return Basics.not(List.isEmpty(GameLogic.playersAtHome($)));
                                                                    });
                                                   return List.head(GameLogic.playersAtHome(playOut(firstGame)));
                                                 }();
                                        });
                     var strategyColors = Dict.fromList(_J.toList([{ctor: "_Tuple2", _0: "ade", _1: Color.blue},
                                                                   {ctor: "_Tuple2", _0: "dae", _1: Color.yellow},
                                                                   {ctor: "_Tuple2", _0: "adh", _1: Color.red},
                                                                   {ctor: "_Tuple2", _0: "dah", _1: Color.green}]));
                     var strategies = _J.toList([{ctor: "_Tuple2", _0: "ade", _1: A2(GameLogic._op[">|>"],
                                                                                     A2(GameLogic._op[">|>"],
                                                                                        GameLogic.aggressiveStyle,
                                                                                        GameLogic.defensiveStyle),
                                                                                     GameLogic.eagerStrategy)},
                                                 {ctor: "_Tuple2", _0: "dae", _1: A2(GameLogic._op[">|>"],
                                                                                     A2(GameLogic._op[">|>"],
                                                                                        GameLogic.defensiveStyle,
                                                                                        GameLogic.aggressiveStyle),
                                                                                     GameLogic.eagerStrategy)},
                                                 {ctor: "_Tuple2", _0: "adh", _1: A2(GameLogic._op[">|>"],
                                                                                     A2(GameLogic._op[">|>"],
                                                                                        GameLogic.aggressiveStyle,
                                                                                        GameLogic.defensiveStyle),
                                                                                     GameLogic.hedgeStrategy)},
                                                 {ctor: "_Tuple2", _0: "dah", _1: A2(GameLogic._op[">|>"],
                                                                                     A2(GameLogic._op[">|>"],
                                                                                        GameLogic.defensiveStyle,
                                                                                        GameLogic.aggressiveStyle),
                                                                                     GameLogic.hedgeStrategy)}]);
                     var clockOf = Signal.lift(function (v)
                                               {
                                                 return {ctor: "_Tuple0"};
                                               });
                     var mergeClocks = F2(function (a,b)
                                          {
                                            return A2(Signal.merge,clockOf(a),clockOf(b));
                                          });
                     var main = function ()
                                {
                                  var pauseForms = _J.toList([Graphics.Collage.outlined(Graphics.Collage.solid(Color.black))(A2(Graphics.Collage.ngon,
                                                                                                                                3,
                                                                                                                                50)),
                                                              Graphics.Collage.move({ctor: "_Tuple2", _0: 10, _1: -60})(Graphics.Collage.toForm(Text.centered(Text.toText("click to start"))))]);
                                  var incWinner = function (winner)
                                                  {
                                                    return function ()
                                                           {
                                                             var inc = function (old)
                                                                       {
                                                                         return function ()
                                                                                {
                                                                                  switch (old.ctor)
                                                                                  {case
                                                                                   "Just" :
                                                                                     return Maybe.Just(old._0 + 1);
                                                                                   case
                                                                                   "Nothing" :
                                                                                     return Maybe.Just(1);}
                                                                                  _E.Case($moduleName,
                                                                                          "between lines 32 and 35");
                                                                                }();
                                                                       };
                                                             return function ()
                                                                    {
                                                                      switch (winner.ctor)
                                                                      {case
                                                                       "Just" :
                                                                         return A2(Dict.update,
                                                                                   winner._0,
                                                                                   inc);
                                                                       case
                                                                       "Nothing" :
                                                                         return Basics.id;}
                                                                      _E.Case($moduleName,
                                                                              "between lines 35 and 39");
                                                                    }();
                                                           }();
                                                  };
                                  var playoff = function (runs)
                                                {
                                                  return runs ? aiPlayoff : F2(function (s,a)
                                                                               {
                                                                                 return -1;
                                                                               });
                                                };
                                  var isRunning = Util.toggleOnce(Mouse.clicks);
                                  var pauseFormsSig = Signal.sampleOn(isRunning)(Signal.constant(pauseForms));
                                  var clock = Time.fps(1);
                                  var noGames = 100;
                                  var gameCount = Util.keepN(noGames + 1)(Signal.count(A3(Signal.keepWhen,
                                                                                          isRunning,
                                                                                          Time.second,
                                                                                          clock)));
                                  var strats = Util.shuffle(Signal.sampleOn(gameCount)(Signal.constant(strategies)));
                                  var playerNames = A2(Signal._op["<~"],
                                                       function ($)
                                                       {
                                                         return Dict.fromList(Util.enumerate(List.map(Basics.fst)($)));
                                                       },
                                                       strats);
                                  var rseed = A3(Random.range,1,GameLogic.dIESIZE,gameCount);
                                  var winnerNo = A2(Signal._op["~"],
                                                    A2(Signal._op["~"],
                                                       A2(Signal._op["<~"],
                                                          playoff,
                                                          Signal.sampleOn(rseed)(isRunning)),
                                                       A2(Signal.lift,List.map(Basics.snd),strats)),
                                                    rseed);
                                  var winnerName = A2(Signal._op["~"],
                                                      A2(Signal._op["<~"],Dict.lookup,winnerNo),
                                                      playerNames);
                                  var countWinners = A3(Signal.foldp,
                                                        incWinner,
                                                        Dict.empty,
                                                        winnerName);
                                  var coloredWinCounts = A2(Signal._op["<~"],
                                                            Util.zipDict(strategyColors),
                                                            countWinners);
                                  var chartForm = A2(Signal._op["<~"],
                                                     function ($)
                                                     {
                                                       return A2(PieChart.pieChartForm,
                                                                 100,
                                                                 30)(Dict.values($));
                                                     },
                                                     coloredWinCounts);
                                  var progressForm = function (p)
                                                     {
                                                       return Graphics.Collage.toForm(Text.centered(Text.toText(_L.append(String.show(p),
                                                                                                                          _L.append("/",
                                                                                                                                    String.show(noGames))))));
                                                     };
                                  var runningFormsSig = Signal.combine(_J.toList([Signal.sampleOn(A2(mergeClocks,
                                                                                                     isRunning,
                                                                                                     gameCount))(chartForm),
                                                                                  A2(Signal._op["<~"],
                                                                                     progressForm,
                                                                                     gameCount)]));
                                  var drawedForms = A4(Util.muc,
                                                       isRunning,
                                                       pauseForms,
                                                       runningFormsSig,
                                                       pauseFormsSig);
                                  return A2(Signal._op["~"],
                                            A2(Signal._op["<~"],
                                               Basics.uncurry(Graphics.Collage.collage),
                                               Window.dimensions),
                                            drawedForms);
                                }();
                     _elm.Playout.values = {_op: _op, main: main, clockOf: clockOf, mergeClocks: mergeClocks, strategies: strategies, strategyColors: strategyColors, aiPlayoff: aiPlayoff};
                     return _elm.Playout.values;
                   };Elm.GameLogic = Elm.GameLogic || {};
Elm.GameLogic.make = function (_elm)
                     {
                       "use strict";
                       _elm.GameLogic = _elm.GameLogic || {};
                       if (_elm.GameLogic.values)
                       return _elm.GameLogic.values;
                       var _N = Elm.Native,
                           _U = _N.Utils.make(_elm),
                           _L = _N.List.make(_elm),
                           _E = _N.Error.make(_elm),
                           _J = _N.JavaScript.make(_elm),
                           $moduleName = "GameLogic";
                       var Basics = Elm.Basics.make(_elm);
                       var Color = Elm.Color.make(_elm);
                       var Dict = Elm.Dict.make(_elm);
                       var Either = Elm.Either.make(_elm);
                       var Graphics = Graphics || {};
                       Graphics.Collage = Elm.Graphics.Collage.make(_elm);
                       var Graphics = Graphics || {};
                       Graphics.Element = Elm.Graphics.Element.make(_elm);
                       var List = Elm.List.make(_elm);
                       var Maybe = Elm.Maybe.make(_elm);
                       var Native = Native || {};
                       Native.Ports = Elm.Native.Ports.make(_elm);
                       var Signal = Elm.Signal.make(_elm);
                       var String = Elm.String.make(_elm);
                       var Text = Elm.Text.make(_elm);
                       var Time = Elm.Time.make(_elm);
                       var Util = Elm.Util.make(_elm);
                       var _op = {};
                       _op[">|>"] = F5(function (f,g,gs,tokA,tokB)
                                       {
                                         return A3(f,gs,tokA,tokB) && A3(f,gs,tokB,tokA) ? A3(g,
                                                                                              gs,
                                                                                              tokA,
                                                                                              tokB) : A3(f,
                                                                                                         gs,
                                                                                                         tokA,
                                                                                                         tokB);
                                       });
                       var betterToSatisfy = F4(function (cond,gs,tokA,tokB)
                                                {
                                                  return A2(cond,gs,tokA) || Basics.not(A2(cond,
                                                                                           gs,
                                                                                           tokB));
                                                });
                       var NoCmd = {ctor: "NoCmd"};
                       var CancelMove = {ctor: "CancelMove"};
                       var MoveToken = function (a)
                                       {
                                         return {ctor: "MoveToken", _0: a};
                                       };
                       var EndOfTurn = {ctor: "EndOfTurn"};
                       var pushCmd = F2(function (cmd,gs)
                                        {
                                          return _U.replace([["trace",
                                                              {ctor: "::", _0: cmd, _1: gs.trace}]],
                                                            gs);
                                        });
                       var logMsg = F2(function (msg,gs)
                                       {
                                         return _U.replace([["log",
                                                             {ctor: "::", _0: msg, _1: gs.log}]],
                                                           gs);
                                       });
                       var GameState = F5(function (a,b,c,d,e)
                                          {
                                            return {_: {}, currentPlayer: a, die: b, log: d, randSeed: e, tokenLoc: c};
                                          });
                       var Location = F2(function (a,b)
                                         {
                                           return {ctor: "Location", _0: a, _1: b};
                                         });
                       var firstLocation = function (p)
                                           {
                                             return A2(Location,p,0);
                                           };
                       var isStartLocation = function (_v0)
                                             {
                                               return function ()
                                                      {
                                                        switch (_v0.ctor)
                                                        {case
                                                         "Location" :
                                                           return _U.cmp(_v0._1,0) < 0;}
                                                        _E.Case($moduleName,
                                                                "on line 46, column 34 to 39");
                                                      }();
                                             };
                       var Token = F2(function (a,b)
                                      {
                                        return {ctor: "Token", _0: a, _1: b};
                                      });
                       var getLocation = F2(function (gs,_v4)
                                            {
                                              return function ()
                                                     {
                                                       switch (_v4.ctor)
                                                       {case
                                                        "Token" :
                                                          return function ()
                                                                 {
                                                                   var _v8 = A2(Dict.lookup,
                                                                                {ctor: "_Tuple2", _0: _v4._0, _1: _v4._1},
                                                                                gs.tokenLoc);
                                                                   switch (_v8.ctor)
                                                                   {case
                                                                    "Just" :
                                                                      return _v8._0;}
                                                                   _E.Case($moduleName,
                                                                           "between lines 118 and 120");
                                                                 }();}
                                                       _E.Case($moduleName,
                                                               "between lines 118 and 120");
                                                     }();
                                            });
                       var isAheadOf = F3(function (gs,tokA,tokB)
                                          {
                                            return function ()
                                                   {
                                                     var $ = A2(getLocation,gs,tokB);
                                                     var lB = function ()
                                                              {
                                                                switch ($.ctor)
                                                                {case
                                                                 "Location" :
                                                                   return $._1;}
                                                                _E.Case($moduleName,
                                                                        "on line 296, column 27 to 46");
                                                              }();
                                                     var $ = A2(getLocation,gs,tokA);
                                                     var lA = function ()
                                                              {
                                                                switch ($.ctor)
                                                                {case
                                                                 "Location" :
                                                                   return $._1;}
                                                                _E.Case($moduleName,
                                                                        "on line 295, column 27 to 46");
                                                              }();
                                                     return _U.cmp(lA,lB) > -1;
                                                   }();
                                          });
                       var hedgeStrategy = F3(function (gs,tokA,tokB)
                                              {
                                                return A3(isAheadOf,gs,tokB,tokA);
                                              });
                       var setLocation = F3(function (_v16,loc,gs)
                                            {
                                              return function ()
                                                     {
                                                       switch (_v16.ctor)
                                                       {case
                                                        "Token" :
                                                          return _U.replace([["tokenLoc",
                                                                              A3(Dict.insert,
                                                                                 {ctor: "_Tuple2", _0: _v16._0, _1: _v16._1},
                                                                                 loc,
                                                                                 gs.tokenLoc)]],
                                                                            gs);}
                                                       _E.Case($moduleName,
                                                               "on line 124, column 10 to 57");
                                                     }();
                                            });
                       var tOKENCNT = 4;
                       var sTARTOFFSET = 2 + 2 * tOKENCNT;
                       var playerTokens = function (player)
                                          {
                                            return A2(List.map,
                                                      Token(player),
                                                      _L.range(0,tOKENCNT - 1));
                                          };
                       var startLocations = function (p)
                                            {
                                              return A2(List.map,
                                                        function ($)
                                                        {
                                                          return Location(p)(F2(function (x,y)
                                                                                {
                                                                                  return x * y;
                                                                                })(-1)($));
                                                        },
                                                        _L.range(1,tOKENCNT));
                                            };
                       var pLAYERCNT = 4;
                       var bOARDSIZE = pLAYERCNT * sTARTOFFSET;
                       var isHomeLocation = function (_v20)
                                            {
                                              return function ()
                                                     {
                                                       switch (_v20.ctor)
                                                       {case
                                                        "Location" :
                                                          return _U.cmp(_v20._1,bOARDSIZE) > -1;}
                                                       _E.Case($moduleName,
                                                               "on line 49, column 33 to 47");
                                                     }();
                                            };
                       var isBoardLocation = function (loc)
                                             {
                                               return Basics.not(isStartLocation(loc) || isHomeLocation(loc));
                                             };
                       var isAtHome = function (gs)
                                      {
                                        return function ($)
                                               {
                                                 return isHomeLocation(getLocation(gs)($));
                                               };
                                      };
                       var eagerStrategy = A2(_op[">|>"],
                                              betterToSatisfy(function (gs)
                                                              {
                                                                return function ($)
                                                                       {
                                                                         return Basics.not(isAtHome(gs)($));
                                                                       };
                                                              }),
                                              isAheadOf);
                       var isValidLocation = function (_v24)
                                             {
                                               return function ()
                                                      {
                                                        switch (_v24.ctor)
                                                        {case
                                                         "Location" :
                                                           return _U.cmp(0 - tOKENCNT,
                                                                         _v24._1) < 1 && _U.cmp(_v24._1,
                                                                                                bOARDSIZE + tOKENCNT) < 0;}
                                                        _E.Case($moduleName,
                                                                "on line 52, column 34 to 74");
                                                      }();
                                             };
                       var absLoc = function (_v28)
                                    {
                                      return function ()
                                             {
                                               switch (_v28.ctor)
                                               {case
                                                "Location" :
                                                  return _U.cmp(_v28._1,
                                                                0) < 0 ? _v28._1 : _U.cmp(_v28._1,
                                                                                          bOARDSIZE) > -1 ? _v28._1 : A2(Basics.mod,
                                                                                                                         sTARTOFFSET * _v28._0 + _v28._1,
                                                                                                                         bOARDSIZE);}
                                               _E.Case($moduleName,"between lines 65 and 67");
                                             }();
                                    };
                       var isSameLocation = F2(function (_v32,_v33)
                                               {
                                                 return function ()
                                                        {
                                                          switch (_v33.ctor)
                                                          {case
                                                           "Location" :
                                                             return function ()
                                                                    {
                                                                      switch (_v32.ctor)
                                                                      {case
                                                                       "Location" :
                                                                         return _U.eq(_v32._0,
                                                                                      _v33._0) ? _U.eq(_v32._1,
                                                                                                       _v33._1) : Basics.not(isBoardLocation(_v32) && isBoardLocation(_v33)) ? false : _U.eq(absLoc(_v32),
                                                                                                                                                                                             absLoc(_v33));}
                                                                      _E.Case($moduleName,
                                                                              "between lines 59 and 61");
                                                                    }();}
                                                          _E.Case($moduleName,
                                                                  "between lines 59 and 61");
                                                        }();
                                               });
                       var returnToStart = F2(function (_v40,gs)
                                              {
                                                return function ()
                                                       {
                                                         switch (_v40.ctor)
                                                         {case
                                                          "Token" :
                                                            return function ()
                                                                   {
                                                                     var occupied = List.filter(isStartLocation)(A2(List.map,
                                                                                                                    getLocation(gs),
                                                                                                                    playerTokens(_v40._0)));
                                                                     var isNotOccupied = function (loc)
                                                                                         {
                                                                                           return Basics.not(A2(List.any,
                                                                                                                isSameLocation(loc),
                                                                                                                occupied));
                                                                                         };
                                                                     var freeLocs = A2(List.filter,
                                                                                       isNotOccupied,
                                                                                       startLocations(_v40._0));
                                                                     var currentLoc = A2(getLocation,
                                                                                         gs,
                                                                                         _v40);
                                                                     var newLoc = isStartLocation(currentLoc) ? currentLoc : function ()
                                                                                                                             {
                                                                                                                               switch (freeLocs.ctor)
                                                                                                                               {case
                                                                                                                                "::" :
                                                                                                                                  return freeLocs._0;
                                                                                                                                case
                                                                                                                                "[]" :
                                                                                                                                  return A2(Location,
                                                                                                                                            _v40._0,
                                                                                                                                            0 - _v40._1 - 1);}
                                                                                                                               _E.Case($moduleName,
                                                                                                                                       "between lines 145 and 148");
                                                                                                                             }();
                                                                     return A3(setLocation,
                                                                               _v40,
                                                                               newLoc,
                                                                               gs);
                                                                   }();}
                                                         _E.Case($moduleName,
                                                                 "between lines 143 and 153");
                                                       }();
                                              });
                       var locationDistance = F2(function (_v47,_v48)
                                                 {
                                                   return function ()
                                                          {
                                                            switch (_v48.ctor)
                                                            {case
                                                             "Location" :
                                                               return function ()
                                                                      {
                                                                        switch (_v47.ctor)
                                                                        {case
                                                                         "Location" :
                                                                           return isHomeLocation(_v47) || isHomeLocation(_v48) ? Maybe.Nothing : Maybe.Just(absLoc(A2(Location,
                                                                                                                                                                      _v47._0,
                                                                                                                                                                      A2(Basics.max,
                                                                                                                                                                         _v47._1,
                                                                                                                                                                         0))) - absLoc(A2(Location,
                                                                                                                                                                                          _v48._0,
                                                                                                                                                                                          A2(Basics.max,
                                                                                                                                                                                             _v48._1,
                                                                                                                                                                                             0))));}
                                                                        _E.Case($moduleName,
                                                                                "between lines 79 and 81");
                                                                      }();}
                                                            _E.Case($moduleName,
                                                                    "between lines 79 and 81");
                                                          }();
                                                 });
                       var advanceLocation = F2(function (dist,_v55)
                                                {
                                                  return function ()
                                                         {
                                                           switch (_v55.ctor)
                                                           {case
                                                            "Location" :
                                                              return function ()
                                                                     {
                                                                       var target = _v55._1 + dist;
                                                                       var maxPosLen = bOARDSIZE + tOKENCNT - 1;
                                                                       var newPos = target - 2 * A2(Basics.max,
                                                                                                    0,
                                                                                                    target - maxPosLen);
                                                                       return A2(Location,
                                                                                 _v55._0,
                                                                                 newPos);
                                                                     }();}
                                                           _E.Case($moduleName,
                                                                   "between lines 71 and 74");
                                                         }();
                                                });
                       var advanceToken = F3(function (_v59,dist,gs)
                                             {
                                               return function ()
                                                      {
                                                        switch (_v59.ctor)
                                                        {case
                                                         "Token" :
                                                           return function ()
                                                                  {
                                                                    var currentLoc = A2(getLocation,
                                                                                        gs,
                                                                                        _v59);
                                                                    var newLoc = A2(advanceLocation,
                                                                                    dist,
                                                                                    currentLoc);
                                                                    return _U.replace([["tokenLoc",
                                                                                        A3(Dict.insert,
                                                                                           {ctor: "_Tuple2", _0: _v59._0, _1: _v59._1},
                                                                                           newLoc,
                                                                                           gs.tokenLoc)]],
                                                                                      gs);
                                                                  }();}
                                                        _E.Case($moduleName,
                                                                "between lines 134 and 136");
                                                      }();
                                             });
                       var getTargetLocation = F2(function (gs,_v63)
                                                  {
                                                    return function ()
                                                           {
                                                             switch (_v63.ctor)
                                                             {case
                                                              "Token" :
                                                                return function ()
                                                                       {
                                                                         var currentLoc = A2(getLocation,
                                                                                             gs,
                                                                                             _v63);
                                                                         return isStartLocation(currentLoc) ? firstLocation(_v63._0) : A2(advanceLocation,
                                                                                                                                          gs.die,
                                                                                                                                          currentLoc);
                                                                       }();}
                                                             _E.Case($moduleName,
                                                                     "between lines 192 and 195");
                                                           }();
                                                  });
                       var allPlayers = _L.range(0,pLAYERCNT - 1);
                       var playersAtHome = function (gs)
                                           {
                                             return A2(List.filter,
                                                       function ($)
                                                       {
                                                         return List.all(isAtHome(gs))(playerTokens($));
                                                       },
                                                       allPlayers);
                                           };
                       var gameOver = function ($)
                                      {
                                        return Basics.not(List.isEmpty(playersAtHome($)));
                                      };
                       var allTokens = A2(List.map,
                                          Basics.uncurry(Token),
                                          A2(Util.combinations,
                                             _L.range(0,pLAYERCNT - 1),
                                             _L.range(0,tOKENCNT - 1)));
                       var lookupOccupant = F2(function (gs,loc)
                                               {
                                                 return function ()
                                                        {
                                                          var _v67 = A2(List.filter,
                                                                        function ($)
                                                                        {
                                                                          return isSameLocation(loc)(getLocation(gs)($));
                                                                        },
                                                                        allTokens);
                                                          switch (_v67.ctor)
                                                          {case
                                                           "::" :
                                                             return Maybe.Just(_v67._0);
                                                           case
                                                           "[]" :
                                                             return Maybe.Nothing;}
                                                          _E.Case($moduleName,
                                                                  "between lines 128 and 130");
                                                        }();
                                               });
                       var emptyLocation = F2(function (loc,gs)
                                              {
                                                return function ()
                                                       {
                                                         var _v70 = A2(lookupOccupant,gs,loc);
                                                         switch (_v70.ctor)
                                                         {case
                                                          "Just" :
                                                            return A2(returnToStart,_v70._0,gs);
                                                          case
                                                          "Nothing" :
                                                            return gs;}
                                                         _E.Case($moduleName,
                                                                 "between lines 157 and 160");
                                                       }();
                                              });
                       var hitsOpponent = function (gs)
                                          {
                                            return function ($)
                                                   {
                                                     return Maybe.isJust(lookupOccupant(gs)(getTargetLocation(gs)($)));
                                                   };
                                          };
                       var aggressiveStyle = betterToSatisfy(hitsOpponent);
                       var activeTokens = function (gs)
                                          {
                                            return A2(List.filter,
                                                      function ($)
                                                      {
                                                        return isBoardLocation(getLocation(gs)($));
                                                      },
                                                      allTokens);
                                          };
                       var initTokenLoc = function ()
                                          {
                                            var unpackedAllTokens = A2(Util.combinations,
                                                                       _L.range(0,pLAYERCNT - 1),
                                                                       _L.range(0,tOKENCNT - 1));
                                            var mkStartLoc = function (_v72)
                                                             {
                                                               return function ()
                                                                      {
                                                                        switch (_v72.ctor)
                                                                        {case
                                                                         "Token" :
                                                                           return A2(Location,
                                                                                     _v72._0,
                                                                                     0 - _v72._1 - 1);}
                                                                        _E.Case($moduleName,
                                                                                "on line 104, column 34 to 52");
                                                                      }();
                                                             };
                                            return Dict.fromList(List.zip(unpackedAllTokens)(A2(List.map,
                                                                                                mkStartLoc,
                                                                                                allTokens)));
                                          }();
                       var initGameState = {_: {}, currentPlayer: 0, die: 6, log: _J.toList([]), randSeed: 3571, tokenLoc: initTokenLoc};
                       var newGame = function (gs)
                                     {
                                       return _U.replace([["tokenLoc",initTokenLoc],
                                                          ["currentPlayer",
                                                           A2(Basics.mod,gs.randSeed,pLAYERCNT)]],
                                                         gs);
                                     };
                       var nextPlayer = function (gs)
                                        {
                                          return _U.replace([["currentPlayer",
                                                              A2(Basics.mod,
                                                                 gs.currentPlayer + 1,
                                                                 pLAYERCNT)]],
                                                            gs);
                                        };
                       var dIESIZE = 6;
                       var throwDice = function (gs)
                                       {
                                         return function ()
                                                {
                                                  var z = 3559 * gs.die + gs.randSeed;
                                                  return _U.replace([["die",
                                                                      A2(Basics.mod,z,dIESIZE) + 1],
                                                                     ["randSeed",z / dIESIZE | 0]],
                                                                    gs);
                                                }();
                                       };
                       var endOfTurn = function ($)
                                       {
                                         return throwDice(nextPlayer($));
                                       };
                       var seedRand = F2(function (seed,gs)
                                         {
                                           return _U.replace([["die",
                                                               A2(Basics.mod,seed,dIESIZE) + 1]],
                                                             gs);
                                         });
                       var tryMove = F2(function (gs,_v76)
                                        {
                                          return function ()
                                                 {
                                                   switch (_v76.ctor)
                                                   {case
                                                    "Token" :
                                                      return function ()
                                                             {
                                                               var targetLoc = A2(getTargetLocation,
                                                                                  gs,
                                                                                  _v76);
                                                               var isOccupiedByOwner = function ()
                                                                                       {
                                                                                         var _v80 = A2(lookupOccupant,
                                                                                                       gs,
                                                                                                       targetLoc);
                                                                                         switch (_v80.ctor)
                                                                                         {case
                                                                                          "Just" :
                                                                                            switch (_v80._0.ctor)
                                                                                            {case
                                                                                             "Token" :
                                                                                               return _U.eq(_v80._0._0,
                                                                                                            _v76._0);}
                                                                                            break;
                                                                                          case
                                                                                          "Nothing" :
                                                                                            return false;}
                                                                                         _E.Case($moduleName,
                                                                                                 "between lines 203 and 207");
                                                                                       }();
                                                               var currentLoc = A2(getLocation,
                                                                                   gs,
                                                                                   _v76);
                                                               return ! _U.eq(gs.currentPlayer,
                                                                              _v76._0) ? Either.Left("Not token of current player") : isStartLocation(currentLoc) && ! _U.eq(gs.die,
                                                                                                                                                                             dIESIZE) ? Either.Left("Can only enter a token on six") : isOccupiedByOwner ? Either.Left("Target location already occupied by current player") : isStartLocation(currentLoc) && _U.eq(gs.die,
                                                                                                                                                                                                                                                                                                                                                                    dIESIZE) ? Either.Right(throwDice(A2(setLocation,
                                                                                                                                                                                                                                                                                                                                                                                                         _v76,
                                                                                                                                                                                                                                                                                                                                                                                                         firstLocation(_v76._0))(A2(emptyLocation,
                                                                                                                                                                                                                                                                                                                                                                                                                                    targetLoc,
                                                                                                                                                                                                                                                                                                                                                                                                                                    gs)))) : Either.Right((_U.eq(gs.die,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                 dIESIZE) ? throwDice : endOfTurn)(A2(advanceToken,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      _v76,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      gs.die)(A2(emptyLocation,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 targetLoc,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 gs))));
                                                             }();}
                                                   _E.Case($moduleName,"between lines 200 and 222");
                                                 }();
                                        });
                       var moveableTokens = F2(function (gs,player)
                                               {
                                                 return A2(List.filter,
                                                           function ($)
                                                           {
                                                             return Either.isRight(tryMove(gs)($));
                                                           },
                                                           playerTokens(player));
                                               });
                       var advanceOnBlocked = function (gs)
                                              {
                                                return function ()
                                                       {
                                                         var _v84 = A2(moveableTokens,
                                                                       gs,
                                                                       gs.currentPlayer);
                                                         switch (_v84.ctor)
                                                         {case
                                                          "[]" :
                                                            return logMsg("No possible moves, passing turn")(endOfTurn(gs));}
                                                         return gs;
                                                       }();
                                              };
                       var execCmd = F2(function (cmd,gs)
                                        {
                                          return function ()
                                                 {
                                                   switch (cmd.ctor)
                                                   {case
                                                    "MoveToken" :
                                                      return function ()
                                                             {
                                                               var _v87 = A2(tryMove,gs,cmd._0);
                                                               switch (_v87.ctor)
                                                               {case
                                                                "Left" :
                                                                  return advanceOnBlocked(A2(logMsg,
                                                                                             _v87._0,
                                                                                             gs));
                                                                case
                                                                "Right" :
                                                                  return _v87._0;}
                                                               _E.Case($moduleName,
                                                                       "between lines 242 and 246");
                                                             }();
                                                    case
                                                    "NoCmd" :
                                                      return advanceOnBlocked(gs);}
                                                   return A2(logMsg,String.show(cmd),gs);
                                                 }();
                                        });
                       var computerPlayer = F3(function (strategy,player,gs)
                                               {
                                                 return function ()
                                                        {
                                                          var isWorseCmd = F2(function (x,y)
                                                                              {
                                                                                return function ()
                                                                                       {
                                                                                         var _v90 = {ctor: "_Tuple2", _0: x, _1: y};
                                                                                         switch (_v90.ctor)
                                                                                         {case
                                                                                          "_Tuple2" :
                                                                                            switch (_v90._0.ctor)
                                                                                            {case
                                                                                             "MoveToken" :
                                                                                               switch (_v90._1.ctor)
                                                                                               {case
                                                                                                "MoveToken" :
                                                                                                  return A3(strategy,
                                                                                                            gs,
                                                                                                            _v90._1._0,
                                                                                                            _v90._0._0);
                                                                                                case
                                                                                                "NoCmd" :
                                                                                                  return false;}
                                                                                               break;
                                                                                             case
                                                                                             "NoCmd" :
                                                                                               switch (_v90._1.ctor)
                                                                                               {case
                                                                                                "MoveToken" :
                                                                                                  return true;}
                                                                                               break;}
                                                                                            break;}
                                                                                         return true;
                                                                                       }();
                                                                              });
                                                          var moveable = A2(List.filter,
                                                                            function ($)
                                                                            {
                                                                              return Either.isRight(tryMove(gs)($));
                                                                            },
                                                                            playerTokens(player));
                                                          return A3(Util.greatest,
                                                                    isWorseCmd,
                                                                    NoCmd,
                                                                    A2(List.map,
                                                                       MoveToken,
                                                                       moveable));
                                                        }();
                                               });
                       var canBeHit = F2(function (gs,_v96)
                                         {
                                           return function ()
                                                  {
                                                    switch (_v96.ctor)
                                                    {case
                                                     "Token" :
                                                       return function ()
                                                              {
                                                                var isHittingDist = function (dist)
                                                                                    {
                                                                                      return function ()
                                                                                             {
                                                                                               switch (dist.ctor)
                                                                                               {case
                                                                                                "Just" :
                                                                                                  return _U.cmp(dist._0,
                                                                                                                dIESIZE) < 1;
                                                                                                case
                                                                                                "Nothing" :
                                                                                                  return false;}
                                                                                               _E.Case($moduleName,
                                                                                                       "between lines 283 and 287");
                                                                                             }();
                                                                                    };
                                                                var tokLoc = A2(getLocation,
                                                                                gs,
                                                                                _v96);
                                                                var differentOwner = function (_v102)
                                                                                     {
                                                                                       return function ()
                                                                                              {
                                                                                                switch (_v102.ctor)
                                                                                                {case
                                                                                                 "Token" :
                                                                                                   return ! _U.eq(_v102._0,
                                                                                                                  _v96._0);}
                                                                                                _E.Case($moduleName,
                                                                                                        "on line 279, column 39 to 46");
                                                                                              }();
                                                                                     };
                                                                var otherTokens = A2(List.filter,
                                                                                     differentOwner,
                                                                                     allTokens);
                                                                var tokenDistances = A2(List.map,
                                                                                        function ($)
                                                                                        {
                                                                                          return locationDistance(tokLoc)(getLocation(gs)($));
                                                                                        },
                                                                                        otherTokens);
                                                                return A2(List.any,
                                                                          isHittingDist,
                                                                          tokenDistances);
                                                              }();}
                                                    _E.Case($moduleName,
                                                            "between lines 278 and 287");
                                                  }();
                                         });
                       var defensiveStyle = betterToSatisfy(canBeHit);
                       _elm.GameLogic.values = {_op: _op, dIESIZE: dIESIZE, pLAYERCNT: pLAYERCNT, tOKENCNT: tOKENCNT, sTARTOFFSET: sTARTOFFSET, bOARDSIZE: bOARDSIZE, allPlayers: allPlayers, allTokens: allTokens, playerTokens: playerTokens, startLocations: startLocations, firstLocation: firstLocation, isStartLocation: isStartLocation, isHomeLocation: isHomeLocation, isValidLocation: isValidLocation, isBoardLocation: isBoardLocation, isSameLocation: isSameLocation, absLoc: absLoc, advanceLocation: advanceLocation, locationDistance: locationDistance, initGameState: initGameState, initTokenLoc: initTokenLoc, newGame: newGame, getLocation: getLocation, setLocation: setLocation, lookupOccupant: lookupOccupant, advanceToken: advanceToken, logMsg: logMsg, pushCmd: pushCmd, returnToStart: returnToStart, emptyLocation: emptyLocation, throwDice: throwDice, seedRand: seedRand, nextPlayer: nextPlayer, endOfTurn: endOfTurn, playersAtHome: playersAtHome, gameOver: gameOver, activeTokens: activeTokens, getTargetLocation: getTargetLocation, tryMove: tryMove, moveableTokens: moveableTokens, advanceOnBlocked: advanceOnBlocked, execCmd: execCmd, betterToSatisfy: betterToSatisfy, hitsOpponent: hitsOpponent, canBeHit: canBeHit, isAtHome: isAtHome, isAheadOf: isAheadOf, defensiveStyle: defensiveStyle, aggressiveStyle: aggressiveStyle, eagerStrategy: eagerStrategy, hedgeStrategy: hedgeStrategy, computerPlayer: computerPlayer, Token: Token, Location: Location, EndOfTurn: EndOfTurn, MoveToken: MoveToken, CancelMove: CancelMove, NoCmd: NoCmd, GameState: GameState};
                       return _elm.GameLogic.values;
                     };Elm.PieChart = Elm.PieChart || {};
Elm.PieChart.make = function (_elm)
                    {
                      "use strict";
                      _elm.PieChart = _elm.PieChart || {};
                      if (_elm.PieChart.values)
                      return _elm.PieChart.values;
                      var _N = Elm.Native,
                          _U = _N.Utils.make(_elm),
                          _L = _N.List.make(_elm),
                          _E = _N.Error.make(_elm),
                          _J = _N.JavaScript.make(_elm),
                          $moduleName = "PieChart";
                      var Basics = Elm.Basics.make(_elm);
                      var Color = Elm.Color.make(_elm);
                      var Graphics = Graphics || {};
                      Graphics.Collage = Elm.Graphics.Collage.make(_elm);
                      var Graphics = Graphics || {};
                      Graphics.Element = Elm.Graphics.Element.make(_elm);
                      var List = Elm.List.make(_elm);
                      var Maybe = Elm.Maybe.make(_elm);
                      var Native = Native || {};
                      Native.Ports = Elm.Native.Ports.make(_elm);
                      var Signal = Elm.Signal.make(_elm);
                      var String = Elm.String.make(_elm);
                      var Text = Elm.Text.make(_elm);
                      var Time = Elm.Time.make(_elm);
                      var _op = {};
                      var zipWith3 = F4(function (f,xs,ys,zs)
                                        {
                                          return function ()
                                                 {
                                                   var _v0 = {ctor: "_Tuple3", _0: xs, _1: ys, _2: zs};
                                                   switch (_v0.ctor)
                                                   {case
                                                    "_Tuple3" :
                                                      switch (_v0._0.ctor)
                                                      {case
                                                       "::" :
                                                         switch (_v0._1.ctor)
                                                         {case
                                                          "::" :
                                                            switch (_v0._2.ctor)
                                                            {case
                                                             "::" :
                                                               return {ctor: "::", _0: A3(f,
                                                                                          _v0._0._0,
                                                                                          _v0._1._0,
                                                                                          _v0._2._0), _1: A4(zipWith3,
                                                                                                             f,
                                                                                                             _v0._0._1,
                                                                                                             _v0._1._1,
                                                                                                             _v0._2._1)};}
                                                            break;}
                                                         break;}
                                                      break;}
                                                   return _J.toList([]);
                                                 }();
                                        });
                      var normalize = function (xs)
                                      {
                                        return function ()
                                               {
                                                 var total = List.sum(xs);
                                                 return A2(List.map,
                                                           function (x)
                                                           {
                                                             return x / total;
                                                           },
                                                           xs);
                                               }();
                                      };
                      var asPercent = function (fraction)
                                      {
                                        return Text.plainText(_L.append(String.show(Basics.toFloat(Basics.truncate(fraction * 100))),
                                                                        "%"));
                                      };
                      var pieSlice = F4(function (radius,offset,angle,colr)
                                        {
                                          return function ()
                                                 {
                                                   var makePoint = function (t)
                                                                   {
                                                                     return Basics.fromPolar({ctor: "_Tuple2", _0: radius, _1: Basics.degrees(360 * offset + t)});
                                                                   };
                                                   return _J.toList([Graphics.Collage.filled(colr)(Graphics.Collage.polygon({ctor: "::", _0: {ctor: "_Tuple2", _0: 0, _1: 0}, _1: A2(List.map,
                                                                                                                                                                                     makePoint,
                                                                                                                                                                                     _L.range(0,
                                                                                                                                                                                              360 * angle))})),
                                                                     Graphics.Collage.move(Basics.fromPolar({ctor: "_Tuple2", _0: radius * 1.25, _1: Basics.turns(offset + angle / 2)}))(Graphics.Collage.toForm(asPercent(angle)))]);
                                                 }();
                                        });
                      var pieChartForm = F3(function (radius,cwidth,slices)
                                            {
                                              return function ()
                                                     {
                                                       var background = Graphics.Collage.filled(Color.gray)(Graphics.Collage.circle(radius));
                                                       var cutout = A2(Graphics.Collage.filled,
                                                                       Color.white,
                                                                       Graphics.Collage.circle(radius - cwidth));
                                                       var $ = List.unzip(slices),
                                                           colors = $._0,
                                                           parts = $._1;
                                                       var fracs = normalize(parts);
                                                       var offsets = A3(List.scanl,
                                                                        F2(function (x,y)
                                                                           {
                                                                             return x + y;
                                                                           }),
                                                                        0,
                                                                        fracs);
                                                       var sliceForms = A4(zipWith3,
                                                                           pieSlice(radius),
                                                                           offsets,
                                                                           fracs,
                                                                           colors);
                                                       return Graphics.Collage.group({ctor: "::", _0: background, _1: _L.append(List.concat(sliceForms),
                                                                                                                                _J.toList([cutout]))});
                                                     }();
                                            });
                      var pieChart = F2(function (radius,cwidth)
                                        {
                                          return function ()
                                                 {
                                                   var singleton = function (x)
                                                                   {
                                                                     return _J.toList([x]);
                                                                   };
                                                   var collsize = Basics.ceiling(2 * radius * 1.25 + 40);
                                                   return function ($)
                                                          {
                                                            return A2(Graphics.Collage.collage,
                                                                      collsize,
                                                                      collsize)(singleton(A2(pieChartForm,
                                                                                             radius,
                                                                                             cwidth)($)));
                                                          };
                                                 }();
                                        });
                      _elm.PieChart.values = {_op: _op, pieChart: pieChart, pieChartForm: pieChartForm};
                      return _elm.PieChart.values;
                    };Elm.Util = Elm.Util || {};
Elm.Util.make = function (_elm)
                {
                  "use strict";
                  _elm.Util = _elm.Util || {};
                  if (_elm.Util.values)
                  return _elm.Util.values;
                  var _N = Elm.Native,
                      _U = _N.Utils.make(_elm),
                      _L = _N.List.make(_elm),
                      _E = _N.Error.make(_elm),
                      _J = _N.JavaScript.make(_elm),
                      $moduleName = "Util";
                  var Basics = Elm.Basics.make(_elm);
                  var Color = Elm.Color.make(_elm);
                  var Dict = Elm.Dict.make(_elm);
                  var Graphics = Graphics || {};
                  Graphics.Collage = Elm.Graphics.Collage.make(_elm);
                  var Graphics = Graphics || {};
                  Graphics.Element = Elm.Graphics.Element.make(_elm);
                  var List = Elm.List.make(_elm);
                  var Maybe = Elm.Maybe.make(_elm);
                  var Native = Native || {};
                  Native.Ports = Elm.Native.Ports.make(_elm);
                  var Random = Elm.Random.make(_elm);
                  var Set = Elm.Set.make(_elm);
                  var Signal = Elm.Signal.make(_elm);
                  var String = Elm.String.make(_elm);
                  var Text = Elm.Text.make(_elm);
                  var Time = Elm.Time.make(_elm);
                  var Transform2D = Elm.Transform2D.make(_elm);
                  var _op = {};
                  var least = function (isLE)
                              {
                                return function ()
                                       {
                                         var min = F2(function (x,y)
                                                      {
                                                        return A2(isLE,x,y) ? x : y;
                                                      });
                                         return List.foldr(min);
                                       }();
                              };
                  var greatest = function (cmp)
                                 {
                                   return least(F2(function (x,y)
                                                   {
                                                     return A2(cmp,y,x);
                                                   }));
                                 };
                  var combinations = F2(function (lstA,lstB)
                                        {
                                          return function ()
                                                 {
                                                   switch (lstA.ctor)
                                                   {case
                                                    "::" :
                                                      return _L.append(A2(List.map,
                                                                          F2(function (v0,v1)
                                                                             {
                                                                               return {ctor: "_Tuple2", _0: v0, _1: v1};
                                                                             })(lstA._0),
                                                                          lstB),
                                                                       A2(combinations,
                                                                          lstA._1,
                                                                          lstB));
                                                    case
                                                    "[]" :
                                                      return _J.toList([]);}
                                                   _E.Case($moduleName,"between lines 153 and 155");
                                                 }();
                                        });
                  var repeatN = F2(function (n,elem)
                                   {
                                     return _U.cmp(n,0) > 0 ? {ctor: "::", _0: elem, _1: A2(repeatN,
                                                                                            n - 1,
                                                                                            elem)} : _J.toList([]);
                                   });
                  _op["!!"] = F2(function (lst,i)
                                 {
                                   return function ()
                                          {
                                            switch (lst.ctor)
                                            {case
                                             "::" :
                                               return _U.cmp(i,0) < 1 ? lst._0 : A2(_op["!!"],
                                                                                    lst._1,
                                                                                    i - 1);}
                                            _E.Case($moduleName,"between lines 144 and 145");
                                          }();
                                 });
                  var applyUntil = F3(function (f,cond,init)
                                      {
                                        return cond(init) ? init : A3(applyUntil,f,cond,f(init));
                                      });
                  var iterateWhile = F3(function (f,cond,init)
                                        {
                                          return cond(init) ? {ctor: "::", _0: init, _1: A3(iterateWhile,
                                                                                            f,
                                                                                            cond,
                                                                                            f(init))} : _J.toList([]);
                                        });
                  var applyN = F3(function (f,times,init)
                                  {
                                    return function ()
                                           {
                                             switch (times)
                                             {case
                                              0 :
                                                return _J.toList([]);}
                                             return {ctor: "::", _0: init, _1: A3(applyN,
                                                                                  f,
                                                                                  times - 1,
                                                                                  f(init))};
                                           }();
                                  });
                  var enumerate = function (lst)
                                  {
                                    return A2(List.zip,_L.range(0,List.length(lst) - 1),lst);
                                  };
                  var fromJust = function (_v7)
                                 {
                                   return function ()
                                          {
                                            switch (_v7.ctor)
                                            {case
                                             "Just" :
                                               return _v7._0;}
                                            _E.Case($moduleName,"on line 124, column 21 to 22");
                                          }();
                                 };
                  var iterateOn = function (f)
                                  {
                                    return Signal.foldp(F2(function (a,b)
                                                           {
                                                             return f(b);
                                                           }));
                                  };
                  var dropAbsent = F2(function (init,s)
                                      {
                                        return A2(Signal._op["<~"],
                                                  fromJust,
                                                  A3(Signal.keepIf,
                                                     Maybe.isJust,
                                                     Maybe.Just(init),
                                                     s));
                                      });
                  var toggleOnce = A2(Signal.foldp,
                                      F2(function (_v10,a)
                                         {
                                           return function ()
                                                  {
                                                    return true;
                                                  }();
                                         }),
                                      false);
                  var toggle = A2(Signal.foldp,
                                  F2(function (_v12,a)
                                     {
                                       return function ()
                                              {
                                                return Basics.not(a);
                                              }();
                                     }),
                                  false);
                  var modCount = function (m)
                                 {
                                   return function ()
                                          {
                                            var add = F2(function (_v14,a)
                                                         {
                                                           return function ()
                                                                  {
                                                                    return A2(Basics.mod,a + 1,m);
                                                                  }();
                                                         });
                                            return A2(Signal.foldp,add,0);
                                          }();
                                 };
                  var muc = F4(function ($switch,init,a,b)
                               {
                                 return function ()
                                        {
                                          var currentB = A3(Signal.dropWhen,
                                                            A2(Signal.sampleOn,b,$switch),
                                                            init,
                                                            b);
                                          var currentA = A3(Signal.keepWhen,
                                                            A2(Signal.sampleOn,a,$switch),
                                                            init,
                                                            a);
                                          return A2(Signal.merge,currentA,currentB);
                                        }();
                               });
                  var dropN = F2(function (n,sig)
                                 {
                                   return function ()
                                          {
                                            var clock = A2(Signal.dropIf,
                                                           function (x)
                                                           {
                                                             return _U.cmp(x,n) < 0;
                                                           },
                                                           0)(Signal.count(sig));
                                            return A2(Signal.sampleOn,clock,sig);
                                          }();
                                 });
                  var keepN = F2(function (n,sig)
                                 {
                                   return function ()
                                          {
                                            var clock = A2(Signal.keepIf,
                                                           function (x)
                                                           {
                                                             return _U.cmp(x,n) < 0;
                                                           },
                                                           0)(Signal.count(sig));
                                            return A2(Signal.sampleOn,clock,sig);
                                          }();
                                 });
                  var zipDict = F2(function (dictA,dictB)
                                   {
                                     return function ()
                                            {
                                              var insertCombined = function (k)
                                                                   {
                                                                     return A2(Dict.insert,
                                                                               k,
                                                                               {ctor: "_Tuple2", _0: fromJust(A2(Dict.lookup,
                                                                                                                 k,
                                                                                                                 dictA)), _1: fromJust(A2(Dict.lookup,
                                                                                                                                          k,
                                                                                                                                          dictB))});
                                                                   };
                                              var allKeys = Set.toList(A2(Set.intersect,
                                                                          Set.fromList(Dict.keys(dictA)),
                                                                          Set.fromList(Dict.keys(dictB))));
                                              return A3(List.foldl,
                                                        insertCombined,
                                                        Dict.empty,
                                                        allKeys);
                                            }();
                                   });
                  var loadingAnimation = function (isVisible)
                                         {
                                           return function ()
                                                  {
                                                    var emptyForm = Graphics.Collage.group(_J.toList([]));
                                                    var emptyFormSig = Signal.sampleOn(isVisible)(Signal.constant(emptyForm));
                                                    var clock = A3(Signal.keepWhen,
                                                                   isVisible,
                                                                   Time.millisecond,
                                                                   Time.fps(30));
                                                    var angle = A2(Signal._op["<~"],
                                                                   function ($)
                                                                   {
                                                                     return Basics.degrees(function (a)
                                                                                           {
                                                                                             return a * 1.5;
                                                                                           }(Basics.toFloat($)));
                                                                   },
                                                                   A2(modCount,360,clock));
                                                    var transform = function (i)
                                                                    {
                                                                      return A2(Transform2D.multiply,
                                                                                Transform2D.rotation(Basics.degrees(i * 60)),
                                                                                A2(Transform2D.translation,
                                                                                   0,
                                                                                   7));
                                                                    };
                                                    var singleton = function (x)
                                                                    {
                                                                      return _J.toList([x]);
                                                                    };
                                                    var mkcircle = function (i)
                                                                   {
                                                                     return Graphics.Collage.groupTransform(transform(i))(singleton(A2(Graphics.Collage.outlined,
                                                                                                                                       Graphics.Collage.solid(Color.black),
                                                                                                                                       Graphics.Collage.circle(2))));
                                                                   };
                                                    var circles = A2(List.map,
                                                                     mkcircle,
                                                                     _L.range(0,5));
                                                    var rotateLoader = function (a)
                                                                       {
                                                                         return A2(Graphics.Collage.groupTransform,
                                                                                   Transform2D.rotation(0 - a),
                                                                                   circles);
                                                                       };
                                                    return A4(muc,
                                                              isVisible,
                                                              emptyForm,
                                                              A2(Signal._op["<~"],
                                                                 rotateLoader,
                                                                 angle),
                                                              emptyFormSig);
                                                  }();
                                         };
                  var rangeList = F3(function (from,to,len)
                                     {
                                       return function ()
                                              {
                                                var mapFloatToRange = function (x)
                                                                      {
                                                                        return Basics.floor(x * Basics.toFloat(to - from + 1)) + from;
                                                                      };
                                                return A2(Signal._op["<~"],
                                                          List.map(mapFloatToRange),
                                                          Random.floatList(len));
                                              }();
                                     });
                  var swap = F3(function (keyX,keyY,dct)
                                {
                                  return function ()
                                         {
                                           var valY = fromJust(A2(Dict.lookup,keyY,dct));
                                           var valX = fromJust(A2(Dict.lookup,keyX,dct));
                                           return A2(Dict.insert,keyX,valY)(A3(Dict.insert,
                                                                               keyY,
                                                                               valX,
                                                                               dct));
                                         }();
                                });
                  var shuffle = function (cards)
                                {
                                  return function ()
                                         {
                                           var applySwaps = function (cdict)
                                                            {
                                                              return function ($)
                                                                     {
                                                                       return A2(List.foldl,
                                                                                 F2(function (x,y)
                                                                                    {
                                                                                      return x(y);
                                                                                    }),
                                                                                 cdict)(List.map(Basics.uncurry(swap))($));
                                                                     };
                                                            };
                                           var floatToRange = function (_v16)
                                                              {
                                                                return function ()
                                                                       {
                                                                         switch (_v16.ctor)
                                                                         {case
                                                                          "_Tuple2" :
                                                                            return {ctor: "_Tuple2", _0: _v16._0, _1: Basics.floor(_v16._1 * Basics.toFloat(_v16._0 + 1))};}
                                                                         _E.Case($moduleName,
                                                                                 "on line 20, column 31 to 63");
                                                                       }();
                                                              };
                                           var cardCnt = A2(Signal._op["<~"],List.length,cards);
                                           var swapPairs = A2(Signal._op["<~"],
                                                              function ($)
                                                              {
                                                                return List.reverse(List.map(floatToRange)(enumerate($)));
                                                              },
                                                              Random.floatList(cardCnt));
                                           var cardsDict = A2(Signal._op["<~"],
                                                              function ($)
                                                              {
                                                                return Dict.fromList(enumerate($));
                                                              },
                                                              cards);
                                           return A2(Signal._op["<~"],
                                                     Dict.values,
                                                     A2(Signal._op["~"],
                                                        A2(Signal._op["<~"],applySwaps,cardsDict),
                                                        swapPairs));
                                         }();
                                };
                  _elm.Util.values = {_op: _op, shuffle: shuffle, swap: swap, rangeList: rangeList, loadingAnimation: loadingAnimation, zipDict: zipDict, keepN: keepN, dropN: dropN, muc: muc, modCount: modCount, toggle: toggle, toggleOnce: toggleOnce, dropAbsent: dropAbsent, iterateOn: iterateOn, fromJust: fromJust, enumerate: enumerate, applyN: applyN, iterateWhile: iterateWhile, applyUntil: applyUntil, repeatN: repeatN, combinations: combinations, least: least, greatest: greatest};
                  return _elm.Util.values;
                };</script></head><body><script type="text/javascript">Elm.fullscreen(Elm.Playout)</script><noscript></noscript></body></html>
